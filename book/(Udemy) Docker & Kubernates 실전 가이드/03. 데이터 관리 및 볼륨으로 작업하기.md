# 43~54강
## 데이터

![[image-and-container-rw.png]]
> 47강 3' 30"

### 기본적인 도커의 데이터 관리
- 이미지는 ReadOnly임.
- 만약에 컨테이너가 실행되면서 쓰기작업이 필요한 경우(임시 appData 혹은 영구데이터), 이미지가 아닌 컨테이너안에 데이터가 추가됨.
	- 그렇기때문에 컨테이너를 중단하고 재시작해도 컨테이너안에 데이터가 잘 남아있음.
	- 하지만 컨테이너에 `--rm` 옵션이 있으면 중단과 동시에 삭제되기 때문에 데이터도 같이 지워짐.

#### 개선점(볼륨)
[[#기본적인 도커의 데이터 관리]]에선 이미지를 재빌드하여 컨테이너를 새롭게 생성&실행하면, 기존 컨테이너에 있던 데이터는 사라진다. 이러한 문제를 해결하기 위해 [[#개선점(볼륨)|볼륨]]을 사용한다.
- **컨테이너에 볼륨을 추가하면, 컨테이너가 제거되어도 볼륨이 유지됨!!**
	- **그 말은, 컨테이너 외부에서 액세스할 수 도 있다는 말임!!**

- Anonymous Volumes
> 실제로 로컬호스트에 어떤 경로로 미러링되는지 모름.

 *->* `--rm`으로 컨테이너를 시작하면, 익명 볼륨도 사라짐.
 *--->* 그렇지 않으면, 익명 볼륨이 계속 쌓임. `docker volume rm {}` 혹은 `docker volume prune`으로 삭제해줘야함.
 
 Dockerfile에서 정의
```dockerfile
VOLUME [ "/app/feedback" ] <- 외부로 드러낼 컨테이너 안에 내부 위치
```

혹은 cli에서
```bash
docker run .... -v {컨테이너 내부 경로}
```

- Named Volumes
 > 영구적으로 보관이 필요한 데이터가 있을 경우 사용.

-> 어떻게든 컨테이너가 제거되어도, 볼륨은 남아있음. (맞나??)
-> Named Volumes는 Dockerfile에서 정의하는 것이 아닌, docker cli에서 정의하는 것.
*->* 수정은 불가능함. 왜냐면 로컬 머신내 어디에 저장될지 모르니깐.
```bash
docker run .... -v "{지정할_볼륨이름}:{컨테이너 내부 경로}"
// 콜론앞에 경로가 아닌게 붙으면, 네임드 볼륨이 됨
```

- Bind Mounts
> 로컬 호스트내 특정 위치를 컨테이너로 마운트함

- 주의사항 : 기존 컨테이너 내 경로를 로컬경로로 완전 대체함.
```bash
docker run .... -v "{로컬경로}:{컨테이너 내부 경로}"
// 콜론앞에 경로가 아닌게 붙으면, 네임드 볼륨이 됨
```
# 55~66 강 
도커 -v를 사용하는 3가지 방법
![[Pasted image 20241108152241.png]]

| 볼륨 유형     | 익명 볼륨                             | 이름이 있는 볼륨                               | 바인드 마운트                                     |
| --------- | --------------------------------- | --------------------------------------- | ------------------------------------------- |
| 생성 목적     | 특정 컨테이너에 대해 생성됨                   | 일반적으로 생성됨 – 특정 컨테이너에 종속되지 않음            | 호스트 파일 시스템의 위치 – 특정 컨테이너에 종속되지 않음           |
| 지속성       | 컨테이너 종료/재시작 시 유지 (`--rm` 사용 시 삭제) | 컨테이너 종료/재시작 시 유지<br>– Docker CLI로 삭제 가능 | 컨테이너 종료/재시작 시 유지<br>– 호스트 파일 시스템에서 삭제 가능    |
| 공유 가능 여부  | 다른 컨테이너와 공유 불가                    | 다른 컨테이너와 공유 가능                          | 다른 컨테이너와 공유 가능                              |
| 재사용 가능 여부 | 익명이므로 재사용 불가 (같은 이미지에서도 사용 불가)    | 동일한 컨테이너에서 재사용 가능 (재시작 포함)              | 동일한 컨테이너에서 재사용 가능 (재시작 포함)                  |
| 사용 예시     | `docker run -v /app/data ...`     | `docker run -v data:/app/data ...`      | `docker run -v /path/to/code:/app/code ...` |

readyonly -> :ro
-v 옵션엔 heritage가 존재함.
작은 개념(작은 폴더)가 오버라이팅


Q. 익명 볼륨의 위치를 찾을 수 있는 방법은 없을까? (애초에 로컬 어딘가에 생기긴 할거같은데)
그렇게 Read-Only인 볼륨을 수정할 수 있는 방법은 없을까?